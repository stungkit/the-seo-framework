"use strict";window.tsfCanonical=function(){function a(a){return p.get(a)}function b(a,b){return b?q[a]?.[b]:q[a]}function c(a,b,c){if(q[a][b]!==c)switch(q[a][b]=c,b){case"allowReferenceChange":case"showUrlPlaceholder":case"preferredScheme":case"urlStructure":case"urlDataParts":default:g(a)}}function d(a){let c="";if(b(a.target.id,"showUrlPlaceholder"))if(b(a.target.id,"allowReferenceChange")){const d=b(a.target.id,"urlStructure"),e=b(a.target.id,"urlDataParts"),f=b(a.target.id,"preferredScheme"),g=m?[]:o.queryReplace;let h=d;o.code.forEach((a,b)=>{if(!h.includes(a))return;let c=null;a in e&&(c=`${e[a]}`.match(new RegExp(o.replace[b].replace(/(\+|\*)\?/g,"$1")))?.[0]??""),h=null===c?h.replace(a,""):h.replace(a,(g[b]??"")+c)}),h=h.replace(/\/{2,}/g,"/"),h=h.replace(/\s+/g,"-");const i=URL.parse(h,n);i.protocol=`${f}:`,c=i.href}else c=b(a.target.id,"defaultCanonical");a.target.placeholder=c}function e(b){b?a(b)?.dispatchEvent(new Event("input")):p.forEach(a=>a.id&&e(a.id))}function f(a){d(a)}function g(a){a in r&&clearTimeout(r[a]),r[a]=setTimeout(()=>e(a),1e3/60)}function h(a){if("tsfAys"in window){let b=tsfAys.areSettingsChanged();e(a),!b&&tsfAys.areSettingsChanged()&&tsfAys.reset()}else e(a)}function i(a){a in s&&clearTimeout(s[a]),s[a]=setTimeout(()=>h(a),1e3/60)}function j(a){!a instanceof Element||(a.addEventListener("input",f),i(a.id))}function k(){window.addEventListener("tsf-counter-updated",()=>i())}const l=tsfCanonicalL10n,m=l.params.usingPermalinks,n=tsf.stripTags(l.params.rootUrl),o=l.params.rewrite,p=new Map,q={};let r={},s={};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",k)}},{setInputElement:function(b){return p.set(b.id,b),q[b.id]={allowReferenceChange:!0,defaultCanonical:"",showUrlPlaceholder:!0,preferredScheme:"",urlStructure:"",urlDataParts:{}},j(b),a(b.id)},getInputElement:a,getStateOf:b,updateStateOf:c,updateStateAll:function(a,b,d){d=Array.isArray(d)?d:[d],p.forEach(e=>{d.includes(e.id)||c(e.id,a,b)})},structIncludes:function(a,c){const d=b(a,"urlStructure");return Array.isArray(c)?c.some(a=>d.includes(a)):d.includes(c)},triggerInput:e,enqueueTriggerInput:g,triggerUnregisteredInput:h,enqueueTriggerUnregisteredInput:i})}(),window.tsfDescription.load();
