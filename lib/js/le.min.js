"use strict";window.tsfLe=function(){function a(){tsfTT.triggerReset()}function b(){for(const a in k){const b=k[a],c=document.getElementById("autodescription-quick[%s]".replace("%s",a));if(c)if(b.isSelect){tsf.selectByValue(c,b.value);const a=c.querySelector("[value=\"0\"]");a&&(a.innerHTML=a.innerHTML.replace("%s",tsf.escapeString(tsf.decodeEntities(b.default))))}else c.value=tsf.decodeEntities(b.value),b.placeholder?.length&&(c.placeholder=tsf.decodeEntities(b.placeholder))}}function c(){return b()}function d(a){const b=document.getElementById(`edit-${a}`);let c="public";if(b?.querySelector("[name=keep_private]")?.checked)c="private";else{const a=b?.querySelector("[name=post_password]")?.value;a?.length&&"0"!==a&&(c="password")}return c}function e(a,b){const c=document.getElementById(`edit-${a}`);b=tsfUtils.debounce(b,20),c?.querySelector("[name=post_password]")?.addEventListener("input",b),c?.querySelector("[name=keep_private]")?.addEventListener("click",b)}function f(a){const b="autodescription-quick[doctitle]",c=document.getElementById(b);if(!c)return;tsfTitle.setInputElement(c);const f=JSON.parse(document.getElementById(`tsfLeTitleData[${a}]`)?.dataset.leTitle||0);if(f&&(tsfTitle.updateStateOf(b,"allowReferenceChange",!f.refTitleLocked),tsfTitle.updateStateOf(b,"defaultTitle",f.defaultTitle.trim()),tsfTitle.updateStateOf(b,"addAdditions",f.addAdditions),tsfTitle.updateStateOf(b,"additionValue",f.additionValue.trim()),tsfTitle.updateStateOf(b,"additionPlacement",f.additionPlacement)),"post"===m){const c=()=>{let c="";switch(d(a)){case"password":c=tsfTitle.protectedPrefix;break;case"private":c=tsfTitle.privatePrefix;break;default:case"public":c=""}tsfTitle.updateStateOf(b,"prefixValue",c)};e(a,c),c()}const g=a=>{const c=(a.originalEvent||a).target,d=c.value?.trim()||"";let e=(tsfTitle.stripTitleTags?tsf.stripTags(d):d)||tsfTitle.untitledTitle;if("tax"===m){const a=f?.tsfTermPrefix?.trim()||"";a.length&&(window.isRtl?e=`${e} ${a}`:e=`${a} ${e}`)}e=tsf.escapeString(tsf.decodeEntities(e.trim())),tsfTitle.updateStateOf(b,"defaultTitle",e)},h=document.getElementById(`edit-${a}`);switch(m){case"post":const a=h?.querySelector("[name=post_title]");a&&!l.isFront&&(a.addEventListener("input",g),a.dispatchEvent(new Event("input")));break;case"tax":const b=h?.querySelector("[name=name]");b&&(b.addEventListener("input",g),b.dispatchEvent(new Event("input")))}tsfTT.triggerReset()}function g(a){const b="autodescription-quick[description]",c=document.getElementById(b);if(c){tsfDescription.setInputElement(c);const d=JSON.parse(document.getElementById(`tsfLeDescriptionData[${a}]`)?.dataset.leDescription||0);d&&(tsfDescription.updateStateOf(b,"allowReferenceChange",!d.refDescriptionLocked),tsfDescription.updateStateOf(b,"defaultDescription",d.defaultDescription.trim())),tsfTT.triggerReset()}}function h(a){const b="autodescription-quick[canonical]",c=document.getElementById("autodescription-quick[noindex]"),e=document.getElementById(b),f=new Map,g=1,h=2;let i=0;tsfCanonical.setInputElement(e);const j=JSON.parse(document.getElementById(`tsfLeCanonicalData[${a}]`)?.dataset.leCanonical||0);j&&(tsfCanonical.updateStateOf(b,"allowReferenceChange",!j.refCanonicalLocked),tsfCanonical.updateStateOf(b,"defaultCanonical",j.defaultCanonical.trim()),tsfCanonical.updateStateOf(b,"preferredScheme",j.preferredScheme.trim()),tsfCanonical.updateStateOf(b,"urlStructure",j.urlStructure)),tsfCanonical.enqueueTriggerUnregisteredInput(b);const l=()=>{tsfCanonical.updateStateOf(b,"showUrlPlaceholder",!(i&g||i&h)),tsfCanonical.updateStateOf(b,"urlDataParts",Object.fromEntries(f.entries()))},n=document.getElementById(`edit-${a}`);if(e&&n)switch(m){case"post":const b=n.querySelector("[name=post_name]"),c=n.querySelector("[name=post_title]"),d=[n.querySelector("[name=aa]"),n.querySelector("[name=mm]"),n.querySelector("[name=jj]"),n.querySelector("[name=hh]"),n.querySelector("[name=mn]"),n.querySelector("[name=ss]")],e=()=>{const a=d.map(a=>a.value);return a[1]&&--a[1],a.map(a=>a??"00")},g=tsfUtils.debounce(()=>{let d=b?.value||c?.value;d=tsfCanonical.sanitizeSlug(d.substring(0,200));const g=new Date(...e()),h=a=>(a+"").padStart(2,"0");f.set(`%year%`,g.getFullYear()).set(`%monthnum%`,h(g.getMonth()+1)).set(`%day%`,h(g.getDate())).set(`%hour%`,h(g.getHours())).set(`%minute%`,h(g.getMinutes())).set(`%second%`,h(g.getSeconds())).set(`%post_id%`,a).set(`%postname%`,d).set(`%category%`,"").set(`%post_tag%`,"").set(`%author%`,""),l()},1e3/60);c?.addEventListener("input",g),b?.addEventListener("input",g),d.forEach(a=>{a?.addEventListener("change",g)});break;case"tax":const h=n.querySelector("input[name=taxonomy]")?.value||"";if(h){const a=n.querySelector("[name=name]"),b=n.querySelector("[name=slug]"),c=tsfUtils.debounce(()=>{let c=b?.value||a?.value;c=tsfCanonical.sanitizeSlug(c.substring(0,200)),f.set(`%${h}%`,c),l()},1e3/60);b?.addEventListener("input",c),a?.addEventListener("input",c),c()}}if(c){const b=tsfUtils.debounce(()=>{let b=c.querySelector("[value=\"0\"]"),e="";switch(d(a)){case"password":case"private":e="noindex",i|=g;break;default:case"public":e=k.noindex.default,i&=~g}b&&(b.innerHTML=c.dataset.defaultI18n.replace("%s",tsf.escapeString(tsf.decodeEntities(e)))),l()},1e3/60);n?.querySelector("[name=post_password]")?.addEventListener("input",()=>b()),n?.querySelector("[name=keep_private]")?.addEventListener("change",()=>b()),b();const e=a=>{let b="";switch(+a){case 0:b=k.noindex.default;break;case-1:b="index";break;case 1:b="noindex"}"noindex"===b?i|=h:i&=~h,l()};c.addEventListener("change",a=>e(a.target.value)),e(c.value)}}function i(){document.addEventListener("tsfLeDispatchUpdate",n),document.addEventListener("tsfLeUpdated",a)}function j(){let a,d;a=window.inlineEditPost?.edit,a&&(window.inlineEditPost.edit=function(c){let d=a.apply(this,arguments);return("object"==typeof c&&(c=window.inlineEditPost?.getId(c)),!c)?d:(m="post",k=JSON.parse(document.getElementById(`tsfLeData[${c}]`)?.dataset.le||0)||{},l=JSON.parse(document.getElementById(`tsfLePostData[${c}]`)?.dataset.lePostData||0)||{},b(c),h(c),f(c),g(c),window.tsfC?.resetCounterListener(),d)}),d=window.inlineEditTax?.edit,d&&(window.inlineEditTax.edit=function(a){let b=d.apply(this,arguments);return("object"==typeof a&&(a=window.inlineEditTax?.getId(a)),!a)?b:(m="tax",k=JSON.parse(document.getElementById(`tsfLeData[${a}]`)?.dataset.le||0)||{},c(a),h(a),f(a),g(a),window.tsfC?.resetCounterListener(),b)})}let k,l,m="";const n=tsfUtils.debounce(()=>{document.dispatchEvent(new CustomEvent("tsfLeUpdated"))},50);return{load:()=>{document.body.addEventListener("tsf-onload",i),document.body.addEventListener("tsf-onload",j)}}}(),window.tsfLe.load();
