"use strict";window.tsfTT=function(){function a(a){const b={mousemove:m.pointerMove,mouseleave:m.pointerLeave,mouseout:m.pointerLeave,touchcancel:m.pointerLeave,blur:m.pointerLeave};return{set:()=>{for(const[c,d]of Object.entries(b))a.addEventListener(c,d);a.addEventListener("tsf-tooltip-update",m.updateDesc),l=a,document.body.addEventListener("click",m.touchDismiss)},unset:()=>{for(const[c,d]of Object.entries(b))a.removeEventListener(c,d);l=void 0,document.body.removeEventListener("click",m.touchDismiss)}}}function b(a){return{lock:()=>{if(a.dataset.preventedClick=1,a instanceof HTMLLabelElement&&a.htmlFor){let b=document.getElementById(a.htmlFor);b&&(b.dataset.preventedClick=1)}a instanceof HTMLInputElement&&a.id&&document.querySelectorAll(`label[for="${a.id}"]`).forEach(a=>{a.dataset.preventedClick=1})},release:()=>{if(a instanceof Element){if(delete a.dataset.preventedClick,a instanceof HTMLLabelElement&&a.htmlFor){let b=document.getElementById(a.htmlFor);b&&delete b.dataset.preventedClick}a instanceof HTMLInputElement&&a.id&&document.querySelectorAll(`label[for="${a.id}"]`).forEach(a=>{delete a.dataset.preventedClick})}},isLocked:()=>a instanceof Element&&!!+a.dataset.preventedClick}}function c(){let c=!1,d=!1;try{(()=>{const a={get passive(){return c=!0,!1},get capture(){return d=!0,!1}};window.addEventListener("tsf-tt-test-passive",null,a),window.removeEventListener("tsf-tt-test-passive",null,a)})()}catch(a){c=!1,d=!1}const e=async(c,d)=>{if(d.dataset.hasTooltip)return;let e=!1;switch(c.type){case"mouseenter":break;case"pointerdown":case"touchstart":e=!0;break;case"focus":default:}e||b(d).lock(),q();(await m.pointerEnter(c,d))&&(m.pointerMove(c),e?r():p(),a(d).set())},f=a=>{b(a.target).isLocked()||(a.preventDefault(),setTimeout(()=>b(a.target).lock()))};let g=!1;const j=a=>{if(!g){g=!0;const b=a.target.closest(k.item);b&&e(a,b),a.stopPropagation(),g=!1}},l=!(c&&d)||{capture:!0,passive:!0},n=()=>{let a=document.querySelectorAll(k.wrap),b="mouseenter pointerdown touchstart focus".split(" ");for(let c=0;c<a.length;c++)b.forEach(b=>{a[c].addEventListener(b,j,l)}),a[c].addEventListener("click",f,!!d&&{capture:!1})};window.addEventListener("tsf-tooltip-reset",n),h()}function d(a,b,c){var d=Math.min;b.dataset.hasTooltip=1;const e=document.createElement("div");e.classList.add(j.base),e.insertAdjacentHTML("afterbegin",`<span class=${j.textWrap}><span class=${j.text}>${c}</span></span><div class=${j.arrow} style=will-change:left></div>`),b.prepend(e);const f=b.closest(k.boundary)||b.closest("#tabs-0-edit-post\\/document-view")||b.closest("#tabs-1-edit-post\\/document-view")||document.getElementById("wpcontent")||document.body,g=f.getBoundingClientRect(),h=g.top-(f.scrollTop||0),i=g.width,l=256,m=b.closest(k.superWrap),n=b.closest(k.wrap)||b.parentElement,o=e.querySelector(k.textWrap),p=m?.getBoundingClientRect(),q=n.getBoundingClientRect();let r;const s=()=>{r=o.getBoundingClientRect()};s();let t=12,u=0;r.width>i-t/2&&(o.style.flexBasis=`${d(l,i-t)}px`,s()),t/=2;const v=g.left-(f.scrollLeft||0),w=v+i,x=r.width,y=r.left,z=y+x,A=p?.width||q.width;if(y<v)u=v-y+t;else if(z>w)u=w-y-x-t;else if(42>A)u=-A/2-t;else if(A>x){let b=a?.pageX||NaN;u="focus"===a?.type?A/2-x/2:isNaN(b)?-t:b-q.left-x/2+t;let c=-t,d=A-x+t;u<c&&(u=c),u>d&&(u=d)}else u=window.isRTL?t:-t;if(u+y<v+t&&(u+=t/2),u+z>w+t&&(u-=t/2),u+y<v&&(u=0),!a){let a=parseInt(o.style.flexBasis,10);u<-a&&(u=-a)}let B=0,C=0,D=0;p&&(B=q.top-p.top,D=q.left-p.left,x<p.width&&(u+=D),C=B,B-=p.height-q.height),e.style.left=`${u}px`,e.dataset.adjust=u-D;const E=b.offsetHeight+8;return h>e.getBoundingClientRect().top-E?(e.classList.add("tsf-tooltip-down"),e.style.top=`${E+C}px`):e.style.bottom=`${E-B}px`,!0}function e(b,c,e){c?.[0]&&(c=c[0]);for(const d of document.querySelectorAll(k.base))f(d),a(d).unset();return!!e.length&&d(b,c,e)}function f(a){a?.[0]&&(a=a[0]),a instanceof HTMLElement&&(delete a.dataset.hasTooltip,b(a).release());const c=g(a);c?.parentNode.removeChild(c)}function g(a){return a?.[0]&&(a=a[0]),a?.classList.contains(j.base)?a:a?.querySelector(k.base)}function h(){clearTimeout(s),s=setTimeout(()=>window.dispatchEvent(new CustomEvent("tsf-tooltip-reset")),100)}const i="tsf-tooltip",j={base:i,item:`${i}-item`,wrap:`${i}-wrap`,superWrap:`${i}-super-wrap`,text:`${i}-text`,textWrap:`${i}-text-wrap`,boundary:`${i}-boundary`,arrow:`${i}-arrow`},k=Object.fromEntries(Object.entries(j).map(([a,b])=>[a,`.${b}`]));let l;const m={updateDesc:a=>{if(a.target.classList.contains(j.item)){let b=a.target.querySelector(k.text);b instanceof Element&&(b.innerHTML=a.target.dataset.desc,a.target.dispatchEvent(new Event("mousemove")))}},touchDismiss:a=>{a.target.closest(k.item)||l&&m.pointerLeave({target:l})},pointerEnter:async(a,b)=>{let c=b.dataset.desc||b.title||"";return!(!c||b.getElementsByClassName(j.base).length)&&(b.dataset.desc=c,b.removeAttribute("title"),await e(a,b,c))},pointerMove:a=>{o.currPos.x=a.pageX||NaN,o.lastMoveEvent=a},pointerLeave:b=>{f(b.target),a(b.target).unset(),b.relatedTarget?.classList?.contains(j.item)||q()}},n={tooltip:void 0,arrow:void 0,wrap:void 0,reset:()=>{n.tooltip=n.arrow=n.wrap=void 0}},o={lastPos:{x:void 0},currPos:{x:void 0},lastMoveEvent:void 0,reset:()=>{o.lastMoveEvent=void 0,o.currPos={x:void 0},o.lastPos={x:void 0}}},{_requestArrowAnimation:p,_cancelArrowAnimation:q,_requestArrowAnimationOnce:r}=(()=>{let a;const b=()=>{a=requestAnimationFrame(e)},c=()=>{cancelAnimationFrame(a),o.lastMoveEvent=void 0,n.reset(),o.reset()},d=()=>{e(),c()},e=()=>{var d=Math.round;let e=![o.currPos.x].includes(NaN);if(e&&o.currPos.x===o.lastPos.x)return void b();o.lastPos.x=o.currPos.x;const f=o.lastMoveEvent,g=f.target;let h=n.tooltip||g.querySelector(k.base);if(!h)return void b();n.tooltip||=h,n.arrow||=h.querySelector(k.arrow),n.wrap||=g.closest(k.wrap)||g.parentNode;let i=o.currPos.x;"focus"===f.type?i=g.getBoundingClientRect().left+g.offsetWidth/2:isNaN(i)&&(i=n.tooltip.dataset.lastPagex||g.getBoundingClientRect().left),n.tooltip.dataset.lastPagex=i;const j=n.tooltip.querySelector(k.textWrap),l=7,m=16;let p=i-n.wrap.getBoundingClientRect().left-m/2,q=n.tooltip.dataset.adjust,r=j.offsetWidth-m-l;if(q=parseInt(q,10),q=isNaN(q)?0:d(q),q&&(p-=q,r+q>n.wrap.offsetWidth)){let a=j.querySelector(k.text),b=a.offsetWidth;r=b-m-l}n.arrow.style.left=p<=l?`${l}px`:p>=r?`${r}px`:`${p}px`,e?b():a&&c()};return{_requestArrowAnimation:b,_cancelArrowAnimation:c,_requestArrowAnimationOnce:d}})();let s;return Object.assign({load:()=>{document.body.addEventListener("tsf-ready",c)}},{doTooltip:e,removeTooltip:f,getTooltip:g,addBoundary:function b(a){a instanceof Element&&a.classList.add(j.boundary)},triggerReset:h,triggerUpdate:function b(a){if(a&&a instanceof Element||(a=document.querySelectorAll(k.item)),!a)return;const c=new CustomEvent("tsf-tooltip-update");a instanceof Element?a.dispatchEvent(c):a instanceof Nodelist&&a.forEach(a=>a.dispatchEvent(c))}})}(),window.tsfTT.load();
